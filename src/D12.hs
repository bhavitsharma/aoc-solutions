import qualified Data.Map as M

type Graph = M.Map Int [Int]

solve :: Graph -> [Int] -> Int -> Int -> ()
solve graph ones = 
    where


